# Overview
mem_chk_perm is a simple utility that tests memory access permissions from a 
userspace application's perspective. It helps analyze writable regions in 
memory, by testing the start, the middle and the end of each region.

# Usage
```
mem_chk_perm
```
# Sample Output
```
Memory Layout:
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| Memory Region                           | Perms| content                                  | Result Bottom        | Result middle        | Result upper         |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x0000000000000000 - 0x000055ea23149000 | ---- | [unmapped]                               | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x000055ea23149000 - 0x000055ea2314a000 | r--p | /tmp/mem_chk_perm/mem_chk_perm           | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x000055ea2314a000 - 0x000055ea2314c000 | r-xp | /tmp/mem_chk_perm/mem_chk_perm           | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x000055ea2314c000 - 0x000055ea2314d000 | r--p | /tmp/mem_chk_perm/mem_chk_perm           | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x000055ea2314d000 - 0x000055ea2314e000 | r--p | /tmp/mem_chk_perm/mem_chk_perm           | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x000055ea2314e000 - 0x000055ea2314f000 | rw-p | /tmp/mem_chk_perm/mem_chk_perm           | written ok           | written ok           | written ok           |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x000055ea2314f000 - 0x000055ea5134c000 | ---- | [unmapped]                               | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x000055ea5134c000 - 0x000055ea51392000 | rw-p | [heap]                                   | written ok           | written ok           | written ok           |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x000055ea51392000 - 0x00007f5d746e4000 | ---- | [unmapped]                               | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007f5d746e4000 - 0x00007f5d74706000 | r--p | /usr/lib/x86_64-linux-gnu/libc-2.31.so   | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007f5d74706000 - 0x00007f5d7487e000 | r-xp | /usr/lib/x86_64-linux-gnu/libc-2.31.so   | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007f5d7487e000 - 0x00007f5d748cc000 | r--p | /usr/lib/x86_64-linux-gnu/libc-2.31.so   | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007f5d748cc000 - 0x00007f5d748d0000 | r--p | /usr/lib/x86_64-linux-gnu/libc-2.31.so   | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007f5d748d0000 - 0x00007f5d748d2000 | rw-p | /usr/lib/x86_64-linux-gnu/libc-2.31.so   | written ok           | written ok           | written ok           |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007f5d748d2000 - 0x00007f5d748d8000 | rw-p | [anonymous]                              | written ok           | written ok           | written ok           |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007f5d748d8000 - 0x00007f5d74907000 | ---- | [unmapped]                               | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007f5d74907000 - 0x00007f5d74908000 | r--p | /usr/lib/x86_64-linux-gnu/ld-2.31.so     | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007f5d74908000 - 0x00007f5d7492b000 | r-xp | /usr/lib/x86_64-linux-gnu/ld-2.31.so     | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007f5d7492b000 - 0x00007f5d74933000 | r--p | /usr/lib/x86_64-linux-gnu/ld-2.31.so     | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007f5d74933000 - 0x00007f5d74934000 | ---- | [unmapped]                               | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007f5d74934000 - 0x00007f5d74935000 | r--p | /usr/lib/x86_64-linux-gnu/ld-2.31.so     | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007f5d74935000 - 0x00007f5d74936000 | rw-p | /usr/lib/x86_64-linux-gnu/ld-2.31.so     | written ok           | written ok           | written ok           |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007f5d74936000 - 0x00007f5d74937000 | rw-p | [anonymous]                              | written ok           | written ok           | written ok           |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
|*0x00007f5d74937000 - 0x00007ffd966d4000*| ---- | [unmapped]                               | denied               | denied               | written ok           |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
|*0x00007ffd966d4000 - 0x00007ffd966f5000*| rw-p | [stack]                                  | written ok           | written ok           | written ok           |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007ffd966f5000 - 0x00007ffd966f9000 | r--p | [vvar]                                   | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007ffd966f9000 - 0x00007ffd966fb000 | r-xp | [vdso]                                   | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0x00007ffd966fb000 - 0xffffffffff600000 | ---- | [unmapped]                               | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0xffffffffff600000 - 0xffffffffff601000 | --xp | [vsyscall]                               | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
| 0xffffffffff601000 - 0xffffffffffffffff | ---- | [unmapped]                               | denied               | denied               | denied               |
+-----------------------------------------+------+------------------------------------------+----------------------+----------------------+----------------------+
```

# Observations
While testing, an unexpected behavior was observed when end region writes
are tested.
Memory just before the stack boundary appeared writable, despite being 
unmapped according to /proc/self/maps. 
This behavior is attributed to Linuxâ€™s stack expansion mechanism. 
The kernel pre-allocates an expansion zone for the stack, allowing 
writes to this reserved area before officially expanding it.

# Notes
* Zones whose address are wrapped in "*" are changed during operation.
* Writing to the memory zone before the stack may not always trigger 
  a segmentation fault due to this pre-allocation.

