# Overview
mem_chk_perm is a simple utility that tests memory access permissions from a 
userspace application's perspective. It helps analyze writable regions in 
memory, particularly around the stack boundary.

# Usage
```
mem_chk_perm <mode>
```
* <mode>: A number (1-7) interpreted as a bitmap indicating where to 
  attempt writes in the tested memory area:
    * Bit 0: Beginning of the memory area
    * Bit 1: Center of the memory area
    * Bit 2: End of the memory area

## sample output
```
Memory Layout:
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| Memory Region                           | Perms| content                                  | TestPID| Result               |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x0000000000000000 - 0x000055ce0c4e6000 | ---- | [unmapped]                               | 41851  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x000055ce0c4e6000 - 0x000055ce0c4e7000 | r--p | /tmp/x/mem_chk_perm                      | 41852  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x000055ce0c4e7000 - 0x000055ce0c4e8000 | r-xp | /tmp/x/mem_chk_perm                      | 41853  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x000055ce0c4e8000 - 0x000055ce0c4e9000 | r--p | /tmp/x/mem_chk_perm                      | 41854  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x000055ce0c4e9000 - 0x000055ce0c4ea000 | r--p | /tmp/x/mem_chk_perm                      | 41855  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x000055ce0c4ea000 - 0x000055ce0c4eb000 | rw-p | /tmp/x/mem_chk_perm                      | 41856  | written ok           |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x000055ce0c4eb000 - 0x000055ce0c533000 | rw-p | [anonymous]                              | 41857  | written ok           |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x000055ce0c533000 - 0x000055ce3ae06000 | ---- | [unmapped]                               | 41858  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x000055ce3ae06000 - 0x000055ce3ae27000 | rw-p | [heap]                                   | 41859  | written ok           |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x000055ce3ae27000 - 0x00007fa9c26ec000 | ---- | [unmapped]                               | 41860  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c26ec000 - 0x00007fa9c270e000 | r--p | /usr/lib/x86_64-linux-gnu/libc-2.31.so   | 41861  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c270e000 - 0x00007fa9c2886000 | r-xp | /usr/lib/x86_64-linux-gnu/libc-2.31.so   | 41862  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c2886000 - 0x00007fa9c28d4000 | r--p | /usr/lib/x86_64-linux-gnu/libc-2.31.so   | 41863  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c28d4000 - 0x00007fa9c28d8000 | r--p | /usr/lib/x86_64-linux-gnu/libc-2.31.so   | 41864  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c28d8000 - 0x00007fa9c28da000 | rw-p | /usr/lib/x86_64-linux-gnu/libc-2.31.so   | 41865  | written ok           |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c28da000 - 0x00007fa9c28e0000 | rw-p | [anonymous]                              | 41866  | written ok           |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c28e0000 - 0x00007fa9c290f000 | ---- | [unmapped]                               | 41867  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c290f000 - 0x00007fa9c2910000 | r--p | /usr/lib/x86_64-linux-gnu/ld-2.31.so     | 41868  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c2910000 - 0x00007fa9c2933000 | r-xp | /usr/lib/x86_64-linux-gnu/ld-2.31.so     | 41869  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c2933000 - 0x00007fa9c293b000 | r--p | /usr/lib/x86_64-linux-gnu/ld-2.31.so     | 41870  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c293b000 - 0x00007fa9c293c000 | ---- | [unmapped]                               | 41871  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c293c000 - 0x00007fa9c293d000 | r--p | /usr/lib/x86_64-linux-gnu/ld-2.31.so     | 41872  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c293d000 - 0x00007fa9c293e000 | rw-p | /usr/lib/x86_64-linux-gnu/ld-2.31.so     | 41873  | written ok           |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c293e000 - 0x00007fa9c293f000 | rw-p | [anonymous]                              | 41874  | written ok           |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007fa9c293f000 - 0x00007ffe21b17000 | ---- | [unmapped]                               | 41875  | written ok           |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007ffe21b17000 - 0x00007ffe21b38000 | rw-p | [stack]                                  | 41876  | written ok           |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007ffe21b38000 - 0x00007ffe21b97000 | ---- | [unmapped]                               | 41877  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007ffe21b97000 - 0x00007ffe21b9b000 | r--p | [vvar]                                   | 41878  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007ffe21b9b000 - 0x00007ffe21b9d000 | r-xp | [vdso]                                   | 41879  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0x00007ffe21b9d000 - 0xffffffffff600000 | ---- | [unmapped]                               | 41880  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0xffffffffff600000 - 0xffffffffff601000 | --xp | [vsyscall]                               | 41881  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
| 0xffffffffff601000 - 0xffffffffffffffff | ---- | [unmapped]                               | 41882  | segfault             |
+-----------------------------------------+------+------------------------------------------+--------+----------------------+
```
# Observations
While testing, an unexpected behavior was observed when using mode 4.
Memory just before the stack boundary appeared writable, despite being 
unmapped according to /proc/self/maps. 
This behavior is attributed to Linuxâ€™s stack expansion mechanism. 
The kernel pre-allocates an expansion zone for the stack, allowing 
writes to this reserved area before officially expanding it.

# Notes
* The Linux kernel initially reserves 128KB for stack growth.

* Writing to the memory zone before the stack may not always trigger 
  a segmentation fault due to this pre-allocation.
